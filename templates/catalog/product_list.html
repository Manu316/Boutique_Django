{# templates/catalog/product_list.html #}
{% extends "base.html" %}
{% load static %}
{% block title %}Productos - Boutique{% endblock %}

{% block content %}
<div class="row">
  <aside class="col-12 col-md-3 mb-3">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Filtros</h5>
        <form id="filter-form" method="get">
          <div class="mb-2">
            <label class="form-label">Talla</label>
            <select class="form-select" name="size">
              <option value="">Todas</option>
              {% for s in sizes %}
                <option value="{{ s }}" {% if size == s %}selected{% endif %}>{{ s }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="mb-2">
            <label class="form-label">Color</label>
            <select class="form-select" name="color">
              <option value="">Todos</option>
              {% for c in colors %}
                <option value="{{ c }}" {% if color == c %}selected{% endif %}>{{ c }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="d-grid gap-2">
            <button class="btn btn-primary" type="submit">Aplicar</button>
            <a class="btn btn-outline-secondary" href="{% url 'product_list' %}">Limpiar</a>
          </div>
        </form>
      </div>
    </div>
  </aside>

  <section class="col-12 col-md-9">
    <div class="row g-3">
      {% for p in products %}
        <div class="col-6 col-lg-4">
          <div class="card h-100">
            <a href="{% url 'product_detail' p.id %}" class="text-decoration-none">
              {% if p.imagen %}
                <img src="{{ p.imagen.url }}" class="card-img-top card-img-fit" alt="{{ p.nombre }}">
              {% else %}
                <div class="card-img-top card-img-fit placeholder-product d-flex
                            align-items-center justify-content-center">
                  <i class="bi bi-image" style="font-size: 2.5rem; opacity:.5;"></i>
                </div>
              {% endif %}
            </a>

            <div class="card-body d-flex flex-column">
              <a href="{% url 'product_detail' p.id %}" class="text-decoration-none text-reset">
                <h6 class="card-title">{{ p.nombre }}</h6>
              </a>

              <p class="text-muted small mb-2">
                {{ p.categoria.nombre|default:"Sin categoría" }}
              </p>

              <div class="mt-auto">
                <span class="fw-semibold">${{ p.precio }}</span><br>
                <small class="text-muted">Stock: {{ p.stock }}</small>
                <a href="{% url 'product_detail' p.id %}" class="btn btn-sm btn-outline-primary w-100 mt-2">
                  Ver detalles
                </a>
              </div>
            </div>
          </div>
        </div>
      {% empty %}
        <div class="col-12">
          <div class="alert alert-info">No hay productos todavía.</div>
        </div>
      {% endfor %}
    </div>
  </section>
</div>
{% endblock %}